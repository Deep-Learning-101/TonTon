<!doctype html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>漏洞自動分析與修復Agent:Buttercup 如何打通檢索—分析—修補—驗證</title>
    <script src="https://cdn.tailwindcss.com/3.4.3"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/framer-motion/10.18.0/framer-motion.umd.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystem-Font, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
            background-color: #f5f5f7;
            color: #1d1d1f;
        }
        .top-info-box {
            background-color: #e9e9ed;
            padding: 1.5rem 2rem;
            border-radius: 1.5rem;
            margin-bottom: 2rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.03);
            text-align: center;
        }
        .top-info-title {
            font-size: 2rem;
            font-weight: 700;
            color: #1d1d1f;
            margin-bottom: 0.5rem;
        }
        .top-info-text {
            font-size: 1rem;
            line-height: 1.6;
            color: #333333;
        }
        .top-info-text p {
            margin-bottom: 0.75rem;
        }
        .top-info-text strong {
             font-weight: 700;
        }
        .top-info-text a {
            color: #0071e3;
            font-weight: 500;
            text-decoration: none;
        }
        .top-info-text a:hover {
            text-decoration: underline;
        }
        .top-info-box table {
            margin: 1.5rem auto;
            border-collapse: collapse;
            width: auto;
        }
        .top-info-box th, .top-info-box td {
            border: 1px solid #ccc;
            padding: 0.5rem 1rem;
            text-align: center;
        }
        .top-info-box th {
            background-color: #e0e0e0;
        }
        .bento-box {
            background-color: #ffffff;
            border-radius: 1.5rem;
            padding: 2rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05), 0 10px 20px rgba(0,0,0,0.05);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            margin-bottom: 1.5rem;
        }
        .bento-title-large {
            font-size: 2.2rem;
            line-height: 2.8rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            color: #1d1d1f;
        }
        .bento-subtitle {
            font-size: 1.25rem;
            font-weight: 600;
            color: #0071e3;
            margin-top: 1.5rem;
            margin-bottom: 0.75rem;
        }
        .bento-text {
            font-size: 1rem;
            line-height: 1.75;
            color: #333333;
        }
        .bento-text strong, .bento-text b {
            font-weight: 600;
            color: #1d1d1f;
        }
        .bento-text a {
            color: #0071e3;
            text-decoration: none;
        }
        .bento-text a:hover {
            text-decoration: underline;
        }
        .bento-text p { margin-bottom: 1rem; }
        .bento-text p:last-child { margin-bottom: 0; }
        .bento-list {
            list-style-type: none;
            padding-left: 0.5rem;
        }
        .bento-list li {
            margin-bottom: 0.75rem;
            padding-left: 1.75rem;
            position: relative;
        }
        .bento-list li::before {
            content: "\f111";
            font-family: "Font Awesome 6 Free";
            font-weight: 900;
            color: #0071e3;
            font-size: 0.5rem;
            position: absolute;
            left: 0.25rem;
            top: 0.5em;
        }
        .icon-large {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            color: #0071e3;
        }
        .content-wrapper {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }
        .chinese-main-title {
            font-size: 2.8rem;
            font-weight: 700;
            line-height: 1.2;
        }
        .tag {
            display: inline-block;
            background-color: #e0e7ff; /* indigo-100 */
            color: #3730a3; /* indigo-800 */
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.8rem;
            font-weight: 500;
            margin-right: 0.5rem;
            margin-bottom: 0.5rem;
        }
    </style>
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "TechArticle",
      "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://twman.org/Cyber/AIxCC-Buttercup.html"
      },
      "headline": "漏洞自動分析與修復Agent:Buttercup 如何打通檢索—分析—修補—驗證",
      "description": "afc-buttercup 是 Trail of Bits 團隊為 AIxCC 總決賽提交的開源版本。該系統將 AI 增強模糊測試、靜態分析與一個創新的「多智能體補丁生成—驗證流水線」相整合，實現檢索、分析、修補到驗證的完整閉環。",
      "image": "https://raw.githubusercontent.com/Deep-Learning-101/TonTon/refs/heads/main/_includes/DL101-Logo.jpg",
      "author": {
        "@type": "Person",
        "name": "TonTon Huang Ph.D.",
        "url": "https://twman.org"
      },
      "publisher": {
        "@type": "Organization",
        "name": "Deep Learning 101, Taiwan",
        "logo": {
          "@type": "ImageObject",
          "url": "https://raw.githubusercontent.com/Deep-Learning-101/TonTon/refs/heads/main/_includes/DL101-Logo.jpg"
        }
      },
      "datePublished": "2025-10-22",
      "keywords": "AIxCC, Buttercup, Trail of Bits, Multi-agent System, Cybersecurity, LangGraph, ReflectionAgent, SWEAgent, LLM, 自動化資安, 漏洞修復"
    }
    </script>
</head>
<body>
    <div id="app" class="content-wrapper">

        <div class="top-info-box">
            <h1 class="top-info-title">Deep Learning 101</h1>
            <div class="top-info-text">
                <p>
                  <strong>Deep Learning 101, Taiwan’s pioneering and highest deep learning meetup, launched on 2016/11/11 @ 83F, Taipei 101</strong>
                </p>
                <p>
                AI是一條孤獨且充滿惶恐及未知的旅程，花俏絢麗的收費課程或活動絕非通往成功的捷徑。<br>
                衷心感謝當時來自不同單位的AI同好參與者實名分享的寶貴經驗；如欲移除資訊還請告知。<br>
                由 <a href="https://twman.org/" target="_blank" rel="noopener noreferrer">TonTon Huang Ph.D.</a> 發起，及其當時任職公司(台灣雪豹科技)無償贊助場地及茶水點心。<br>
                Deep Learning 101 創立初衷，是為了普及與分享深度學習及AI領域的尖端知識，深信AI的價值在於解決真實世界的商業問題。<br>
                </p>
                <p>
                    <a href="https://www.youtube.com/@DeepLearning101" target="_blank" rel="noopener noreferrer">去 YouTube 訂閱</a> |
                    <a href="https://www.facebook.com/groups/525579498272187/" target="_blank" rel="noopener noreferrer">Facebook</a> |
                    <a href="https://deep-learning-101.github.io/" target="_blank" rel="noopener noreferrer">回 GitHub Pages</a> |
                    <a href="https://github.com/Deep-Learning-101" target="_blank" rel="noopener noreferrer">到 GitHub 點星</a> |
                    <a href="https://huggingface.co/DeepLearning101" target="_blank" rel="noopener noreferrer">到 Hugging Face Space 按愛心</a>
                </p>
                 <table>
                  <tr>
                    <th align="center"><a href="https://deep-learning-101.github.io/Large-Language-Model">大語言模型</a></th>
                    <th align="center"><a href="https://deep-learning-101.github.io/Speech-Processing">語音處理</a></th>
                    <th align="center"><a href="https://deep-learning-101.github.io/Natural-Language-Processing">自然語言處理</a></th>
                    <th align="center"><a href="https://deep-learning-101.github.io/Computer-Vision">電腦視覺</a></th>
                  </tr>
                  <tr>
                    <td><a href="https://github.com/Deep-Learning-101/Natural-Language-Processing-Paper?tab=readme-ov-file#llm">Large Language Model</a></td>
                    <td><a href="https://github.com/Deep-Learning-101/Speech-Processing-Paper">Speech Processing</a></td>
                    <td><a href="https://github.com/Deep-Learning-101/Natural-Language-Processing-Paper">Natural Language Processing, NLP</a></td>
                    <td><a href="https://github.com/Deep-Learning-101/Computer-Vision-Paper">Computer Vision</a></td>
                  </tr>
                </table>
            </div>
        </div>

        <header class="text-center my-12">
            <h1 class="chinese-main-title bg-clip-text text-transparent bg-gradient-to-r from-blue-600 via-sky-500 to-cyan-400">
                <a href="https://deep-learning-101.github.io/cyber/AIxCC-Buttercup" target="_blank" rel="noopener noreferrer">漏洞自動分析與修復Agent:Buttercup 如何打通檢索—分析—修補—驗證閉環</a>
            </h1>
        </header>
        <div class="bento-box motion-div">
            <i class="fas fa-feather-alt icon-large"></i>
            <h2 class="bento-title-large">精選文章 (Featured Articles)</h2>
            <div class="bento-text">
                <details close>
                    <summary class="bento-subtitle cursor-pointer">用 AI 懂 AI (Understanding AI with AI)</summary>
                    <ul class="bento-list mt-4">
                        <li><b><a href="https://deep-learning-101.github.io/Paper/Chain-of-Thought" target="_blank">Chain-of-Thought is not explainability</a></b></li>
                        <li><b><a href="https://deep-learning-101.github.io/Paper/2506.21521_Potemkin-Understanding" target="_blank">arXiv 2506.21521 (Potemkin Understanding in Large Language Models)</a></b></li>
                        <li><b><a href="https://deep-learning-101.github.io/Paper/2502.04644_Oxford_Agentic-Reasoning.html" target="_blank">arXiv 2502.04644 (Agentic Reasoning)</a></b></li>
                        <li><b><a href="https://deep-learning-101.github.io/Blog/AIBeginner" target="_blank">AI新賽局：企業的入門策略指南</a></b></li>
                        <li><b><a href="https://deep-learning-101.github.io/Blog/TW-LLM-Benchmark" target="_blank">臺灣大型語言模型性能評測與在地化策略分析報告</a></b></li>
                        <li><b><a href="https://www.twman.org/AI/Finance" target="_blank">GenAI 與 LLM 在金融產業的應用分析</a></b></li>
                        <li><b><a href="https://blog.twman.org/2025/03/AIAgent.html" target="_blank">避開 AI Agent 開發陷阱：常見問題、挑戰與解決方案</a></b></li>
                    </ul>
                </details>
                <details>
                     <summary class="bento-subtitle cursor-pointer">AI 技術 體驗/分享 (AI Tech Deep Dive)</summary>
                     <ul class="bento-list mt-4">
                        <li><b><a href="https://blog.twman.org/2024/08/LLM.html" target="_blank">白話文手把手帶你科普 GenAI</a></b></li>
                        <li><b><a href="https://blog.twman.org/2024/09/LLM.html" target="_blank">大型語言模型直接就打完收工？</a></b></li>
                        <li><b><a href="https://blog.twman.org/2024/07/RAG.html" target="_blank">檢索增強生成(RAG)不是萬靈丹之優化挑戰技巧</a></b></li>
                     </ul>
                </details>
                 <details>
                    <summary class="bento-subtitle cursor-pointer">AI 技術 開源/試用 (Open Source / Demos)</summary>
                    <ul class="bento-list mt-4">
                        <li><b><a href="https://deep-learning-101.github.io/Blog/Dify-Coze-n8n-AutoGen-LangChain" target="_blank">Dify、Coze、n8n、AutoGen、LangChain等熱門 Agent 框架</a></b>
                        </li>
                        <li><b><a href="https://deep-learning-101.github.io/Blog/vLLM-Ollama-SGLang-LLaMAcpp" target="_blank">vLLM、Ollama、SGLang、 LLaMA.cpp等四大主流熱門LLM服務框架</a></b>
                        </li>
                        <li><b><a href="https://deep-learning-101.github.io/gemini-fullstack-langgraph/FinGenAI" target="_blank">gemini-fullstack-langgraph體驗</a></b>
                        </li>
                        <li><b><a href="https://deep-learning-101.github.io/FinRobot/FinRobot-GOOGL" target="_blank">基於 AutoGen的FinRobot體驗</a></b>
                        </li>
                        <li><b><a href="https://deep-learning-101.github.io/Blog/Cloudflared-Tunnel" target="_blank">用 Cloudflared 實作 SSH / HTTP / RDP Tunnel</a></b>
                        </li>
                    </ul>
                </details>
                 <details>
                    <summary class="bento-subtitle cursor-pointer">AI x Cyber-Security</summary>
                    <ul class="bento-list mt-4">
                        <li><b><a href="https://twman.org/Cyber/AIxCC-Atlanta.html">AIxCC，冠軍：亞特蘭大團隊 (Team-Atlanta/aixcc-afc-atlantis)</a></b></li>
                        <li><b><a href="https://twman.org/Cyber/AIxCC-Buttercup.html">AIxCC，亞軍：Trail of Bits (AFC-Buttercup)</a></b>
                        </li>
                        <li><b><a href="https://twman.org/Cyber/AIxCC-shellphish.html">Shellphish，你所需要的只是 MCP - LLMs 解決 DEF CON CTF 決賽挑戰</a></b></li>
                        <li><b><a href="https://twman.org/Cyber/LLM-Guard.html">AI 大模型安全護欄綜合報告：從核心技術架構到市場趨勢</a></b>
                        </li>
                        <li><b><a href="https://twman.org/Cyber/LLM-Offense.html">大型語言模型（LLM）安全攻防策略深度解析</a></b>
                        </li>
                    </ul>
                </details>
            </div>
        </div>
        <div class="bento-box source-links bento-text">
            <p>
                同步匯整自 <a href="https://zread.ai/trailofbits/afc-buttercup" target="_blank" rel="noopener noreferrer">https://zread.ai/trailofbits/afc-buttercup</a><br>
                同步匯整自 <a href="https://github.com/trailofbits/afc-buttercup" target="_blank" rel="noopener noreferrer"><code>trailofbits/afc-buttercup</code></a>：包含 AIxCC 總決賽中提交的原始程式碼<br>
                同步匯整自 <a href="https://mp.weixin.qq.com/s/3AB2fRQd7QGjMaWXeJABuQ" target="_blank" rel="noopener noreferrer">漏洞自動分析與修復Agent:Buttercup 如何打通檢索—分析—修補—驗證閉環</a><br>
                同步匯整自 <a href="https://deep-learning-101.github.io/cyber/AIxCC-Buttercup" target="_blank" rel="noopener noreferrer">漏洞自動分析與修復Agent:Buttercup </a>
            </p>
            <p class="mt-4">`afc-buttercup` 是 Trail of Bits 團隊為 AIxCC 總決賽（AFC）提交的開源版本。該系統將 AI 增強模糊測試、靜態分析（如 tree-sitter/CodeQuery）與一個創新的「多智能體補丁生成—驗證流水線」相整合。最終，`afc-buttercup` 斬獲 AIxCC 總決賽亞軍，並在 20 類 CWE 上實現了高準確度的漏洞發現與修復表現。</p>
        </div>

        <div class="bento-box motion-div">
            <h2 class="bento-title-large" id="1-buttercup-核心多智能體協作架構"><i class="fas fa-project-diagram icon-large mr-4 text-blue-500"></i>1. Buttercup 核心：多智能體協作架構</h2>
            <div class="bento-text">
                <p>Buttercup 的自動化補丁流程並非單一模型，而是由多個各司其職的專職 Agent 協同運作，形成一條高內聚、低耦合的流水線。系統將複雜的補丁任務拆分為上下文檢索、根因分析、補丁生成、測試驗證和失敗反思等獨立環節。</p>
            </div>
        </div>
        
        <div class="bento-box motion-div">
            <h2 class="bento-title-large" id="2-agent-職責與工作流詳解"><i class="fas fa-users-cog icon-large mr-4 text-purple-500"></i>2. Agent 職責與工作流詳解</h2>
            <div class="bento-text">
                <p>系統的核心由七個主要的 Agent 組成，由 <code>PatcherLeaderAgent</code> 統一編排調度。</p>
                
                <h3 class="bento-subtitle" id="21-patcherleaderagent-總控指揮官">2.1 PatcherLeaderAgent (總控指揮官)</h3>
                <ul class="bento-list">
                    <li><strong>職責：</strong> 作為補丁流水線的「總控/編排」Agent。</li>
                    <li><strong>作法：</strong> 負責組裝和調度所有子 Agent。它透過 <code>_init_patch_team</code> 方法構建一個多節點的狀態機（StateGraph），定義完整的自動補丁工作流，並啟動和管理整個任務。</li>
                </ul>

                <h3 class="bento-subtitle" id="22-inputprocessingagent-輸入預處理">2.2 InputProcessingAgent (輸入預處理)</h3>
                <ul class="bento-list">
                    <li><strong>職責：</strong> 在補丁生成前，負責輸入環境和上下文的初始化與準備。</li>
                    <li><strong>作法：</strong> 解析並應用工作目錄等配置，並初始化 <code>codequery</code> 等代碼查詢工具，確保後續分析能獲取準確的代碼結構資訊。</li>
                </ul>
                
                <h3 class="bento-subtitle" id="23-contextretrieveragent-智能上下文補全器">2.3 ContextRetrieverAgent (智能上下文補全器)</h3>
                <ul class="bento-list">
                    <li><strong>職責：</strong> 作為流水線中的「智能上下文補全器」，動態檢索並補全上下文資訊。</li>
                    <li><strong>作法：</strong> 當主流程 Agent 發現資訊不足或 LLM 請求更多上下文時，此 Agent 會被自動調用。
                        <ul style="padding-left: 20px; list-style-type: circle; margin-top: 0.5rem;">
                           <li><code>get_initial_context</code>：根據崩潰堆棧資訊，自動提取相關的關鍵代碼片段（函數名、文件名、行號）。</li>
                           <li><code>find_tests_node</code>：透過查找腳本、從 Redis 查找指令或 <code>find_tests_agent</code> 自動探索等多種方法，為補丁驗證階段準備可用的測試指令。</li>
                        </ul>
                    </li>
                </ul>
                
                <h3 class="bento-subtitle" id="24-rootcauseagent-漏洞根因分析">2.4 RootCauseAgent (漏洞根因分析)</h3>
                <ul class="bento-list">
                    <li><strong>職責：</strong> 負責漏洞根因分析，定位問題本質。</li>
                    <li><strong>作法：</strong>
                        <ul style="padding-left: 20px; list-style-type: circle; margin-top: 0.5rem;">
                            <li><strong>LLM 驅動：</strong> 入口為 <code>analyze_vulnerability</code>，主要使用 <code>openai-gpt-4.1</code> 和 <code>claude-3.7-sonnet</code> 模型分析漏洞成因，並解析返回的結構化資訊（如 <code>root_cause</code>、<code>vuln_line</code> 等）。</li>
                            <li><strong>工具注入 (MCP)：</strong> 如果 LLM 分析時需要更多上下文，可透過工具注入機制，自動調用一系列工具（如 <code>ls</code>、<code>grep</code>、<code>get_function</code>、<code>get_type</code>、<code>get_callers</code> 等）來補充資訊。</li>
                        </ul>
                    </li>
                </ul>

                <h3 class="bento-subtitle" id="25-sweagent-ai-開發工程師">2.5 SWEAgent (AI 開發工程師)</h3>
                <ul class="bento-list">
                    <li><strong>職責：</strong> 作為「AI 開發工程師」，專注於補丁策略制定和代碼修復生成。</li>
                    <li><strong>作法：</strong>
                        <ol style="padding-left: 20px; list-style-type: decimal; margin-top: 0.5rem;">
                            <li style="margin-bottom: 0.5rem;"><strong>選擇補丁策略 (select_patch_strategy)：</strong>
                                <ul style="padding-left: 20px; list-style-type: disc; margin-top: 0.5rem;">
                                    <li>Agent 會組裝包含根因分析、代碼片段等的 Prompt，調用 LLM 生成結構化的補丁策略（Patch Strategy）。</li>
                                    <li>如果 LLM 輸出 <code>&lt;request_information&gt;</code>，代表需補充上下文，流程會先跳轉至 <code>ContextRetrieverAgent</code>。</li>
                                    <li>Foucs, 提取 <code>&lt;full_description&gt;</code>（詳細設計說明）和 <code>&lt;summary&gt;</code>（核心思路概括）作為補丁策略。</li>
                                </ul>
                            </li>
                            <li><strong>生成具體補丁 (create_patch_node)：</strong>
                                <ul style="padding-left: 20px; list-style-type: disc; margin-top: 0.5rem;">
                                    <li>組裝包含「補丁策略」和根因分析結果的 Prompt，調用 LLM 生成最終的修復補丁。</li>
                                </ul>
                            </li>
                        </ol>
                    </li>
                </ul>
                
                <h3 class="bento-subtitle" id="26-qeagent-品質保障工程師">2.6 QEAgent (品質保障工程師)</h3>
                 <ul class="bento-list">
                    <li><strong>職責：</strong> 作為「品質保障工程師」，負責補丁生成後的自動化測試與有效性校驗。</li>
                    <li><strong>作法：</strong>
                         <ul style="padding-left: 20px; list-style-type: circle; margin-top: 0.5rem;">
                            <li><code>build_patch_node</code>： 核心驗證節點。它會調用 <code>_build_with_sanitizer</code>，在乾淨環境下應用補丁並「並行」編譯項目（針對每個 sanitizer）。</li>
                            <li><strong>流程跳轉：</strong> 如果所有 sanitizer 均構建成功，流程進入 <code>RUN_POV</code>（運行測試/驗證）階段；如果構建失敗，則進入 <code>REFLECTION</code>（反思）階段。</li>
                         </ul>
                    </li>
                </ul>

                <h3 class="bento-subtitle" id="27-reflectionagent-自適應反思與補救">2.7 ReflectionAgent (自適應反思與補救)</h3>
                <ul class="bento-list">
                    <li><strong>職責：</strong> 負責反思與補救，是實現流程閉環和魯棒性的關鍵。當主流程遇到異常或失敗（如構建失敗、測試失敗）時，此 Agent 會接管流程。</li>
                    <li><strong>作法：</strong>
                        <ul style="padding-left: 20px; list-style-type: circle; margin-top: 0.5rem;">
                            <li><code>_analyze_failure</code>： 收集詳細失敗數據（如 <code>stdout/stderr</code>），調用 LLM 反思鏈（<code>self.reflection_chain</code>）分析失敗原因、歸納失敗類別。</li>
                            <li><strong>動態調度：</strong> 根據 LLM 的反思建議，自動決定「下一個環節」，例如是退回 <code>CONTEXT_RETRIEVER</code> 補充上下文、退回 <code>ROOT_CAUSE_ANALYSIS</code> 重新分析根因，還是退回 <code>SWEAgent</code> 調整 <code>PATCH_STRATEGY</code>。</li>
                            <li><code>reflect_on_patch</code>： 如果 LLM 明確請求更多代碼片段（<code>code_snippet_requests</code>），會自動切換到 <code>CONTEXT_RETRIEVER</code> 節點補充資訊，反思後再回到原節點繼續。</li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>

        <div class="bento-box motion-div">
            <h2 class="bento-title-large" id="3-關鍵工作流程自動修復的閉環實現"><i class="fas fa-sync-alt icon-large mr-4 text-green-500"></i>3. 關鍵工作流程：自動修復的閉環實現</h2>
            <div class="bento-text">
                <p>Buttercup 的 Agent 協作形成了一個完整的「檢索-分析-修補-驗證-反思」閉環：</p>
                <ol class="bento-list" style="list-style-type: decimal; padding-left: 2.5rem;">
                    <li><strong>啟動與預處理 (InputProcessing)：</strong> 初始化環境，準備 <code>codequery</code> 工具。</li>
                    <li><strong>上下文檢索 (ContextRetriever)：</strong> Berdasarkan <code>get_initial_context</code> 堆棧崩潰，獲取初始代碼上下文。</li>
                    <li><strong>根因分析 (RootCause)：</strong> <code>RootCauseAgent</code> 介入，使用 LLM 和工具集分析漏洞成因。</li>
                    <li><strong>補丁生成 (SWEAgent)：</strong> <code>SWEAgent</code> 制定 <code>patch_strategy</code>（包含 <code>&lt;full_description&gt;</code> 和 <code>&lt;summary&gt;</code>），然後 <code>create_patch_node</code> 生成補丁。</li>
                    <li><strong>構建與驗證 (QEAgent)：</strong> <code>QEAgent</code> 嘗試並行 <code>build_patch_node</code>。</li>
                    <li><strong>反思與閉環 (Reflection)：</strong>
                        <ul style="padding-left: 20px; list-style-type: disc; margin-top: 0.5rem;">
                            <li><strong>若驗證成功：</strong> 流程結束。</li>
                            <li><strong>若驗證失敗：</strong> <code>ReflectionAgent</code> 接管。它調用 LLM 分析失敗日誌 (<code>_analyze_failure</code>)，並做出決策：是 <code>ContextRetrieverAgent</code> 補充上下文，還是 <code>RootCauseAgent</code> 重新分析，或是 <code>SWEAgent</code> 重新制定策略。</li>
                        </ul>
                    </li>
                </ol>
            </div>
        </div>

        <div class="bento-box motion-div">
            <h2 class="bento-title-large" id="4-核心特性與總結"><i class="fas fa-key icon-large mr-4 text-gray-500"></i>4. 核心特性與總結</h2>
            <div class="bento-text">
                <p>`afc-buttercup` 是一個以多智能體和大模型為核心，兼具工程實用性與 AI 智能化的自動化安全補丁平台。</p>
                <ul class="bento-list">
                    <li><strong>多智能體協作架構：</strong> 將流程拆分為多個專職 Agent，實現高內聚、低耦合的流水線。</li>
                    <li><strong>強大的 LLM 驅動與工具鏈注入：</strong> 透過 LLM（如 GPT-4、Claude）驅動決策，並支持自動調用代碼檢索、<code>grep</code>、<code>get_function</code> 等工具。</li>
                    <li><strong>自適應反思與流程調度：</strong> <code>ReflectionAgent</code> 能自動分析失敗原因、檢測死循環，並動態調整流程，保證了系統的魯棒性和持續進步能力。</li>
                    <li><strong>並行與容錯機制：</strong> 支持多 sanitizer 並行 build/test，主備 LLM 自動切換，以及 Agent 層面的重試保護，提升了效率與穩定性。</li>
                    <li><strong>安全導向與結構化數據流：</strong> 所有決策均聚焦於安全修復，且補丁策略、失敗分析等均採用結構化管理，便於追蹤和優化。</li>
                </ul>
            </div>
        </div>

    </div>
    <script>
    document.addEventListener('DOMContentLoaded', () => {
        const { animate, inView } = motion;

        inView('header', () => {
            animate('header h1', { opacity: [0, 1], y: [-20, 0] }, { duration: 0.6, ease: 'easeOut', delay: 0.2 });
        });
        
        const motionDivs = document.querySelectorAll('.motion-div');
        motionDivs.forEach((div) => {
            inView(div, () => {
                animate(div, 
                    { opacity: [0, 1], y: [30, 0], scale: [0.98, 1] },
                    { duration: 0.65, delay: 0.1, ease: "easeOut" }
                );
            }, { once: true, amount: 0.1 });
        });
    });
    </script>
</body>
</html>
